<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src='./main.js' type="module"></script>
    <link rel="stylesheet" href="/main.css">
</head>
<body>

<div id="login-container">
    <div class="login-box">
        <h1>Welcome to Falling Bricks</h1>
        <p>Enter your name to start:</p>
        <input type="text" id="player-name" placeholder="Your Name" maxlength="12">
        <button id="start-game-btn">Start Game</button>
    </div>
</div>

<div id="gameContainer">
    <div id="ui">
        <div>Score: <span id="score">0</span>s</div>
    </div>

    <div id="gameOver">
        <h2>Game Over!</h2>
        <p>Final Score: <span id="finalScore">0</span> seconds</p>
        <button onclick="restartGame()">Play Again</button>
    </div>

    <div id="pausegame">
        <h2>PAUSED</h2>
        <p>Press SPACEBAR to resume</p>
    </div>

    <div id="instructions">
        Use WASD or Arrow Keys to move<br>
        Press SPACEBAR to pause/resume<br>
        Avoid the falling blocks!
    </div>

    <div id="leaderboard">
        <button id="leaderboardbutton">Leaderboard</button>
    </div>

    <div id="slider-box">
        <div class="slider-row">
            <span class="slider-label">Ground Size:</span>
            <input type="range" id="groundSizeSlider" min="10" max="30" value="20" step="1">
            <span class="slider-value" id="groundSizeValue">20</span>
        </div>
        <div class="slider-row">
            <span class="slider-label">Player Speed:</span>
            <input type="range" id="playerSpeedSlider" min="0.05" max="0.3" value="0.15" step="0.01">
            <span class="slider-value" id="playerSpeedValue">0.15</span>
        </div>
        <div class="slider-row">
            <span class="slider-label">Block Speed:</span>
            <input type="range" id="blockSpeedSlider" min="0.05" max="0.25" value="0.1" step="0.01">
            <span class="slider-value" id="blockSpeedValue">0.10</span>
        </div>
        <div class="slider-row">
            <span class="slider-label">Spawn Rate:</span>
            <input type="range" id="spawnRateSlider" min="100" max="2000" value="1000" step="50">
            <span class="slider-value" id="spawnRateValue">1000ms</span>
        </div>
    </div>

</div>

<div id="leaderboard-container">
    <div class="leaderboard-header">
        <div class="header-rank">Rank</div>
        <div class="header-name">Player</div>
        <div class="header-score">Score</div>
    </div>
<!--    Example entry-->
<!--    <div class="leaderboard-entry">-->
<!--        <div class="entry-rank">1</div>-->
<!--        <div class="entry-name">Player A</div>-->
<!--        <div class="entry-score">1000</div>-->
<!--    </div>-->

</div>

<!--When sliding the slider and then trying to play game, it will not stay focused on the sliders (have left/right keys not
move slider and instead jump back to the game-->
<script>
    document.querySelectorAll('#slider-box .slider-row').forEach(row => {
        const slider = row.querySelector('input[type="range"]');
        const valueSpan = row.querySelector('.slider-value');

        // Update value as slider moves
        slider.addEventListener('input', () => {
            if (slider.id === 'spawnRateSlider') {
                valueSpan.textContent = slider.value + 'ms';
            } else {
                valueSpan.textContent = slider.value;
            }
        });

        // Remove focus on mouse/touch release so arrow keys work for game again
        slider.addEventListener('mouseup', () => slider.blur());
        slider.addEventListener('touchend', () => slider.blur());
    });


    document.addEventListener('DOMContentLoaded', function() {
        const button = document.getElementById('leaderboardbutton');
        const container = document.getElementById('leaderboard-container');

        // Add click event listener
        button.addEventListener('click', function() {
            if(document.getElementById('leaderboard-container').style.display === 'block'){
                document.getElementById('leaderboard-container').style.display = 'none';
            }
            else{
                document.getElementById('leaderboard-container').style.display = 'block';
            }
        });

        document.addEventListener('click', function(event) {
            if (!container.contains(event.target) && event.target !== button) {
                container.style.display = 'none';
            }

        });

        container.addEventListener('click', function(event) {
            event.stopPropagation();
        });
    });

</script>
<script type="module">
    import { init, initializeSliders } from './main.js';

    const startBttn = document.getElementById('start-game-btn');
    const player = document.getElementById('player-name');
    startBttn.addEventListener('click', function() {
        init(player.value);
        initializeSliders();
        document.getElementById('login-container').style.display = 'none';
    });
</script>
</body>
</html>